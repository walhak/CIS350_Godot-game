[gd_scene load_steps=5 format=3 uid="uid://dtgiboxac13rj"]

[ext_resource type="Texture2D" uid="uid://d0p2vla1kpjfq" path="res://Sprites/Fall (32x32).png" id="1_km8e6"]
[ext_resource type="Script" path="res://Charaters/Camera2D.gd" id="3_rr731"]

[sub_resource type="GDScript" id="GDScript_ierdh"]
script/source = "extends CharacterBody2D

#max speed character moves at
@export var speed = 365

#how high the character jumps
@export var jump_power = -1350

#how fast the character gets to max speed
@export var accleration = 70

#how fast the character slows with no input being done
@export var friction = 90

#how fast the character falls to the \"floor\"
@export var gravity = 110

#number of times the character can jump
@export var max_jumps = 1

#currently how many jumps the character did
var current_jumps = 0

#name of each level
var rep_cur = [\"M1\", \"M2\", \"menu\"]
#path to each level
var current_level = [\"res://Levels/Level_1/Map1.tscn\", \"res://Levels/Level_2/Map2.tscn\", \"res://Menu/menu.tscn\"]

#check if character is on the odor
var check = false

#main update to allow movement
func _physics_process(delta):
	var input_dir: Vector2 = input()
	
	#how the character resets on each level and progresses to next level
	if get_tree().get_current_scene() != null:
		#tracks what level character on
		var current_scene_name = get_tree().get_current_scene().get_name()
		var index = rep_cur.find(current_scene_name)
		
		#moves character to next level pressing (s)
		if Input.is_action_just_pressed(\"move_down\") and check == true:
			current_scene_name = get_tree().get_current_scene().get_name()
			index = rep_cur.find(current_scene_name)
			var next_scene_path = current_level[index+1]
			get_tree().change_scene_to_file(next_scene_path)
			
		#allows character to reset pressing (r)
		if Input.is_action_just_pressed(\"resetButton\"):
			current_scene_name = get_tree().get_current_scene().get_name()
			index = rep_cur.find(current_scene_name)
			get_tree().change_scene_to_file(current_level[index])
	
	#allows character to quit game pressing (esc)
	if Input.is_action_just_pressed(\"exitGame\"):
		get_tree().quit()
		
	#updates character movement
	if input_dir != Vector2.ZERO:
		acclerate(input_dir)
	else:
		add_friction()
	
	player_movement()
	jump()
	
#gets the user input and returns the user input
func input() -> Vector2:
	var input_dir = Vector2.ZERO
	input_dir.x = Input.get_axis(\"move_left\", \"move_right\")	#left input gives '-1' and right input give '1'
	input_dir = input_dir.normalized()
	return input_dir
	
#what speeds up character/character movement
func acclerate(direction):
	#direction is left or right on what
	#speed is the rate of movement
	#accleration is how fast til max speed
	velocity = velocity.move_toward(speed * direction, accleration)
	
#slow down
func add_friction():
	velocity = velocity.move_toward(Vector2.ZERO, friction)
	
#update character movement to match what is being inacted
func player_movement(): 
	move_and_slide()
	
#how the character jumps if it didn't use all it's jumps
func jump():
	if Input.is_action_just_pressed(\"move_up\"):
		if current_jumps < max_jumps:
			current_jumps += 1
			velocity.y = jump_power
	else:
		velocity.y += gravity
	
#check if character is on ground floor to reset the number of jumper character can do
	if is_on_floor():
		current_jumps = 0
		
#how character moves to next level and check if they are in the doorway
func _on_area_2d_body_entered(body):
	if body == self:
		check = true
		
#checks if character left the doorway to disable the movement to next level
func _on_area_2d_body_exited(body):
	check = false


func _on_area_2d_21_body_exited(body):
	pass # Replace with function body.


func _on_area_2d_21_body_entered(body):
	pass # Replace with function body.
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_s0y32"]
size = Vector2(63, 91)

[node name="Character1" type="CharacterBody2D"]
script = SubResource("GDScript_ierdh")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(3.5, 5.5)
shape = SubResource("RectangleShape2D_s0y32")

[node name="BlackSprite" type="Sprite2D" parent="."]
visibility_layer = 256
position = Vector2(0, 3.125)
scale = Vector2(2.47656, 3.00781)
texture = ExtResource("1_km8e6")

[node name="Camera2D" type="Camera2D" parent="."]
limit_left = -48
limit_top = -48
limit_right = 2100
limit_bottom = 672
script = ExtResource("3_rr731")
